(this["webpackJsonpgenshin-music"]=this["webpackJsonpgenshin-music"]||[]).push([[0],{176:function(e,t,n){},177:function(e,t,n){"use strict";n.r(t);var a=n(8),s=n(15),o=n(17),r=n(16),i=n(7),c=n.n(i),l=n(73),u=n.n(l),d=n(6),h=n.n(d),p=n(10),g=(n(52),n(84),n(36)),m=function e(){var t=this;Object(a.a)(this,e),this.init=function(){t.start=(new Date).getTime()-100,console.log("Started new recording")},this.addNote=function(e){0===t.notes.length&&t.init();var n=[e,(new Date).getTime()-t.start];t.notes.push(n)},this.start=(new Date).getTime(),this.notes=[]},f=function e(t){var n=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(a.a)(this,e),this.name=t,this.version=1,this.notes=s,this.bpm=220,this.pitch="C",this.data={isComposed:!1,isComposedVersion:!1},Object.entries(o).forEach((function(e){n.data[e[0]]=e[1]}))},v=function e(t,n,s){var o=this;Object(a.a)(this,e),this.trigger=function(){window.dispatchEvent(o.event)},this.title=t,this.timeout=s,this.text=n,void 0===s&&(this.timeout=3e3),this.event=new CustomEvent("logEvent",{detail:{title:this.title,text:this.text,timeout:this.timeout}})},b=function e(t){Object(a.a)(this,e),this.timestamp=(new Date).getTime(),this.notes=t},j=function e(t){var n=this;Object(a.a)(this,e),this.download=function(e,t){var a=n.dataType+encodeURIComponent(e),s=document.createElement("a");s.style="display:none",document.body.appendChild(s),s.setAttribute("href",a),s.setAttribute("download",t),s.click(),s.remove()},void 0===t&&(t="text/json"),this.dataType="data:"+t+";charset=utf-8,"},x=[{id:0,text:"1",changer:1,color:5332079},{id:1,text:"1/2",changer:.5,color:5073230},{id:2,text:"1/4",changer:1/3,color:4410493},{id:3,text:"1/8",changer:1/4,color:7295336}],y=function e(t){var n=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(a.a)(this,e),o.isComposed=!0,o.isComposedVersion=!0,this.version=1,this.data=o,this.name=t,this.bpm=220,this.pitch="C",this.notes=s,this.breakpoints=[0],this.columns=[],this.selected=0,new Array(100).fill().forEach((function(e){var t=new N;t.tempoChanger=0,n.columns.push(t)}))};function w(e){var t,n,a,s={data:e.data,name:e.name,bpm:null!==(t=e.bpm)&&void 0!==t?t:220,pitch:null!==(n=e.pitch)&&void 0!==n?n:"C",breakpoints:null!==(a=e.breakpoints)&&void 0!==a?a:[],notes:[],selected:0,columns:[]};return e.columns.forEach((function(e){var t=new N;t.tempoChanger=e[0],e[1].forEach((function(e){t.notes.push(new E(e[0],e[1]))})),s.columns.push(t)})),s}function S(e){var t=new f(e.name),n=Math.floor(6e4/e.bpm),a=100;return e.columns.forEach((function(e){e[1].forEach((function(e){t.notes.push([e[0],a])})),a+=Math.floor(n*x[e[0]].changer)})),t}function O(e){var t={data:e.data,name:e.name,bpm:e.bpm,pitch:e.pitch,breakpoints:e.breakpoints,columns:[]};return e.columns.forEach((function(e){var n=[e.tempoChanger],a=e.notes.map((function(e){return[e.index,e.layer]}));n[1]=a,t.columns.push(n)})),t}var k=[7,8,9,10,11,12,13,0,1,2,3,4,5,6,6];function C(e){var t=Math.floor(6e4/e.bpm),n=new y(e.name,[]);n.bpm=e.bpm,n.pitch=e.pitch;for(var a=e.notes,s=[],o=function(e,t){var n=[];for(;e.length>0;){for(var a=[e.shift()],s=0,o=0;o<e.length;o++)a[0][1]>e[o][1]-t&&s++;n.push([].concat(a,Object(g.a)(e.splice(0,s))))}return n}(a,t/9),r=[t,Math.floor(t/2),Math.floor(t/4),Math.floor(t/8)],i=function(e){var t=new N;t.notes=o[e].map((function(e){var t=new E(e[0]);return 1===e[2]&&(t.layer="100"),2===e[2]&&(t.layer="010"),3===e[2]&&(t.layer="110"),void 0===e[2]&&(t.layer="100"),t}));for(var n=(o[e+1]||[[0,0,0]])[0][1]-o[e][0][1],a=[];n>=r[3];)n/r[0]>=1?(n-=r[0],a.push(0)):n/r[1]>=1?(n-=r[1],a.push(1)):n/r[2]>=1?(n-=r[2],a.push(2)):n/r[3]>=1&&(n-=r[3],a.push(3));var i=[];t.tempoChanger=a.shift()||0,a=a.forEach((function(e,t){var n=new N;n.tempoChanger=e,i.push(n)})),s.push.apply(s,[t].concat(i))},c=0;c<o.length;c++)i(c);return n.columns=s,n}var N=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5332079;Object(a.a)(this,e),this.notes=[],this.color=t,this.tempoChanger=0};var E=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"000",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:13876622;Object(a.a)(this,e),this.index=t,this.layer=n,this.color=s},T=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"];function P(e){var t=T.indexOf(e);return t<0&&(t=0),Number(Math.pow(2,t/12).toFixed(2))}var M=n(74),A=function e(t,n,s){Object(a.a)(this,e),this.index=t,this.noteNames=n,this.url=s,this.buffer=new ArrayBuffer(8)},D=function e(t){var n=this;Object(a.a)(this,e),this.setBuffers=function(e){e.forEach((function(e,t){n.layout[t].buffer=e}))},this.load=function(){var e=Object(p.a)(h.a.mark((function e(t){var a,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.layout.map((function(e){return fetch(e.url).then((function(e){return e.arrayBuffer()})).then((function(e){return new Promise((function(n,a){t.decodeAudioData(e,n,a)}))}))})),e.next=3,Promise.all(a);case 3:return s=e.sent,n.setBuffers(s),e.abrupt("return",!0);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),this.instrumentName=t,this.layout=[],this.keyboardLayout="Q W E R T Y U A S D F G H J Z X C V B N M".split(" "),this.mobileLayout="do re mi fa so la ti do re mi fa so la ti do re mi fa so la ti".split(" ");var s=0;if(void 0!==t){var o,r=Object(M.a)(this.keyboardLayout);try{for(r.s();!(o=r.n()).done;){var i={keyboard:o.value,mobile:this.mobileLayout[s]},c="./assets/audio/".concat(t,"/").concat(s,".mp3"),l=new A(s,i,c);this.layout.push(l),s++}}catch(u){r.e(u)}finally{r.f()}}},R=n(29),L=n.n(R),B=n(0),I=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var s;return Object(a.a)(this,n),(s=t.call(this,e)).state={},s}return Object(s.a)(n,[{key:"render",value:function(){var e=this,t=this.props.data,n=t.clicked?"note click-event":"note";n+=(this.props.toBeClicked?" note-red":"")+(this.props.toBeClickedNext?" note-border-click":"");var a=L()()?t.noteNames.mobile:t.noteNames.keyboard,s={transition:"all ".concat(this.props.fadeTime,"s")};return Object(B.jsx)("button",{onPointerDown:function(){return e.props.clickAction(t)},className:"button-hitbox",children:Object(B.jsxs)("div",{className:n,style:s,children:[Object(B.jsx)("img",{alt:t.noteNames.mobile,src:"./assets/icons/keys/".concat(t.noteNames.mobile,".svg")}),Object(B.jsx)("div",{className:"note-name",children:a})]})})}}]),n}(i.Component),W=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var s;Object(a.a)(this,n),(s=t.call(this,e)).handleKeyboard=function(e){var t=e.key.toUpperCase();if("INPUT"!==document.activeElement.tagName){var n=s.state.instrument.layout.find((function(e){return e.noteNames.keyboard===t}));void 0!==n&&s.handleClick(n)}},s.handlePlayEvent=function(e){var t=e.detail;s.setState({playTimestamp:t.timestamp},(function(){return s.playSong(t)}))},s.handlePracticeEvent=function(e){var t=e.detail;s.practiceSong(JSON.parse(JSON.stringify(t)))},s.loadInstrument=function(){var e=Object(p.a)(h.a.mark((function e(t){var n,a,o;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new D(t),a=n.layout.map((function(e){return e.url})),e.next=4,s.preload(a);case 4:o=e.sent,n.setBuffers(o),s.setState({instrument:n});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.practiceSong=function(e){var t=e.notes,n=t.length;void 0===e.start&&(e.start=0),t.splice(0,e.start);for(var a=[],o=0;t.length>0;o++){for(var r={notes:[t.shift()],delay:0},i=r.notes.length>0?r.notes[0][1]:0,c=0;c<t.length&&c<20;c++){t[c][1]-r.notes[0][1]-e.threshold<0&&(r.notes.push(t.shift()),c--)}r.delay=t.length>0?t[0][1]-i:0,a.push(r)}s.setState({songToPractice:a}),s.setSlider({size:n,position:e.start})},s.changeSliderPosition=function(e){var t=s.state.sliderState;t.position+=e,s.setState({sliderState:t},(function(){return s.props.functions.changeSliderState(s.state.sliderState)}))},s.setSlider=function(e){s.setState({sliderState:e},s.props.functions.changeSliderState(e))},s.playSong=function(){var e=Object(p.a)(h.a.mark((function e(t){var n,a,o,r,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.notes,a=0,s.setSlider({size:n.length,position:0}),0!==n.length){e.next=5;break}return e.abrupt("return");case 5:o=0;case 6:if(!(o<n.length)){e.next=19;break}if(r=n[o][1]-a,a=n[o][1],i=n[o][0],s.state.playTimestamp===t.timestamp){e.next=12;break}return e.abrupt("break",19);case 12:return e.next=14,U(r);case 14:s.changeSliderPosition(1),s.playSound(s.state.instrument.layout[i]);case 16:o++,e.next=6;break;case 19:s.props.functions.stopSong();case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.handleClick=function(e){var t=s.state.songToPractice;if(t.length>0){var n,a=null===(n=t[0])||void 0===n?void 0:n.notes.findIndex((function(t){return t[0]===e.index}));-1!==a&&(t[0].notes.splice(a,1),0===t[0].notes.length&&t.shift(),0===t.length&&s.props.functions.stopSong(),s.setState({songToPractice:t},(function(){return s.changeSliderPosition(1)})))}s.playSound(e)},s.playSound=function(e){s.props.isRecording&&s.props.functions.handleRecording(e),e.clicked=!0,setTimeout((function(){e.clicked=!1,s.setState({instrument:s.state.instrument})}),200);var t=s.state.audioContext.createBufferSource();t.playbackRate.value=P(s.props.settings.pitch.value),t.buffer=e.buffer,s.props.settings.caveMode.value?t.connect(s.state.reverbAudioContext):t.connect(s.state.audioContext.destination),t.start(0),s.setState({instrument:s.state.instrument})},s.preload=function(e){var t=e.map((function(e){return fetch(e).then((function(e){return e.arrayBuffer()})).then((function(e){return new Promise((function(t,n){s.state.audioContext.decodeAudioData(e,t,n)}))}))}));return Promise.all(t)},s.state={instrument:new D,audioContext:new(window.AudioContext||window.webkitAudioContext),reverbAudioContext:new(window.AudioContext||window.webkitAudioContext),playTimestamp:(new Date).getTime(),songToPractice:[],sliderState:{position:0,size:0}},s.loadInstrument(e.data.instrument);try{s.loadReverb()}catch(o){console.log("Error with reverb")}return s}return Object(s.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.handleKeyboard),window.addEventListener("playSong",this.handlePlayEvent),window.addEventListener("practiceSong",this.handlePracticeEvent)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyboard),window.removeEventListener("playSong",this.handlePlayEvent),window.removeEventListener("practiceSong",this.handlePracticeEvent),this.state.playTimestamp=(new Date).getTime()}},{key:"loadReverb",value:function(){var e=this,t=this.state.audioContext;fetch("./assets/audio/reverb4.wav").then((function(e){return e.arrayBuffer().catch((function(){console.log("Error with reverb ")}))})).then((function(n){return t.decodeAudioData(n,(function(n){var a=t.createConvolver(),s=t.createGain();s.gain.value=2.5,a.buffer=n,a.connect(s),s.connect(t.destination),e.setState({reverbAudioContext:a})}))})).catch((function(){console.log("Error with reverb")}))}},{key:"render",value:function(){var e=this,t=this.state,n=this.props.settings.keyboardSize.value/100;return n<.5&&(n=.5),n>1.5&&(n=1.5),Object(B.jsx)("div",{className:"keyboard",style:{transform:"scale(".concat(n,")")},children:t.instrument.layout.map((function(n){var a,s,o,r,i=void 0!==(null===(a=t.songToPractice[0])||void 0===a?void 0:a.notes.find((function(e){return e[0]===n.index}))),c=void 0!==(null===(s=t.songToPractice[1])||void 0===s?void 0:s.notes.find((function(e){return e[0]===n.index}))),l=void 0!==(null===(o=t.songToPractice[0])||void 0===o?void 0:o.delay)?(null===(r=t.songToPractice[0])||void 0===r?void 0:r.delay)/1e3:.1;return Object(B.jsx)(I,{toBeClicked:i,fadeTime:l,toBeClickedNext:c,data:n,clickAction:e.handleClick},n.index)}))})}}]),n}(i.Component),U=function(e){return new Promise((function(t){return setTimeout(t,e)}))},V=W,F=n(33),H=n(12),G=n(9),_=(n(53),n(75)),J=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var s;return Object(a.a)(this,n),(s=t.call(this,e)).toggleMenu=function(e){"boolean"!==typeof e&&(e=void 0);var t=void 0!==e?e:!s.state.open;s.setState({open:t})},s.selectSideMenu=function(e){if(e===s.state.selectedMenu&&s.state.open)return s.setState({open:!1});s.setState({selectedMenu:e,open:!0})},s.changeSelectedSongType=function(e){s.setState({selectedSongType:e})},s.importSong=function(e){var t=new FileReader;t.addEventListener("load",(function(e){try{var t=JSON.parse(e.target.result),n=function(e){try{return Array.isArray(e)&&e.length>0&&(e=e[0]),Array.isArray(e.songNotes)&&void 0!==e.bitsPerPage?[!0,"true"].includes(e.isComposed)?"skyComposed":"skyRecorded":e.data.isComposedVersion?"string"!==typeof e.name||"number"!==typeof e.bpm?"none":T.includes(e.pitch)&&Array.isArray(e.breakpoints)?e.breakpoints.length>0&&"number"!==typeof e.breakpoints[0]?"none":Array.isArray(e.columns)?e.columns.length>0&&"number"!==typeof e.columns[0][0]?"none":"genshinComposed":"none":"none":"string"!==typeof e.name||"number"!==typeof e.bpm?"none":T.includes(e.pitch)?"genshinRecorded":"none"}catch(t){return console.log(t),"none"}return"none"}(t);if("none"===n)return new v("Error","Invalid song").trigger();["skyRecorded","skyComposed"].includes(n)&&(t=function(e){var t=new f("Error");try{e=e[0],(t=new f(e.name)).bpm=e.bpm||220,t.pitch=T[e.pitch||0],e.songNotes.forEach((function(e){var n=e.key.split("Key")[1];t.notes.push([k[n],e.time,e.l||1])})),[!0,"true"].includes(e.isComposed)?t=O(C(t)):t.notes=t.notes.map((function(e){return[e[0],e[1]]}))}catch(n){return console.log(n),new f("Error importing")}return t}(t)),console.log(n,t),s.props.functions.addSong(t)}catch(a){new v("Error","Error importing song").trigger(),console.error(a)}})),t.readAsText(e)},s.downloadSong=function(e){e._id&&delete e._id;var t=JSON.stringify(e);(new j).download(t,e.name+".gensheet")},s.state={open:!1,selectedMenu:"Settings",selectedSongType:"recorded"},s}return Object(s.a)(n,[{key:"render",value:function(){var e=this,t=this.state.open?"side-menu menu-open":"side-menu",n=this.state.selectedMenu,a=this.props,s=a.data,o=a.functions,r=o.handleSettingChange;o.toggleMenu=this.toggleMenu,o.downloadSong=this.downloadSong;var i=this.props.functions.changePage,c=s.songs.filter((function(e){return!e.data.isComposedVersion})),l=s.songs.filter((function(e){return e.data.isComposedVersion}));return Object(B.jsxs)("div",{className:"menu-wrapper",children:[Object(B.jsxs)("div",{className:"menu menu-visible",children:[this.state.open&&Object(B.jsx)(K,{action:this.toggleMenu}),Object(B.jsx)(Q,{type:"Songs",action:this.selectSideMenu,className:"margin-top-auto",children:Object(B.jsx)(H.a,{icon:G.i,className:"icon"})}),Object(B.jsx)(Q,{type:"Settings",action:this.selectSideMenu,children:Object(B.jsx)(H.a,{icon:G.d,className:"icon"})}),Object(B.jsx)(Q,{type:"Composer",action:function(){return i("Composer")},children:Object(B.jsx)(H.a,{icon:G.e,className:"icon"})})]}),Object(B.jsxs)("div",{className:t,children:[Object(B.jsx)(z,{title:"No selection",visible:n}),Object(B.jsxs)(z,{title:"Songs",visible:n,children:[Object(B.jsx)("div",{className:"songs-buttons-wrapper",children:Object(B.jsx)(_.FilePicker,{onChange:function(t){return e.importSong(t)},children:Object(B.jsx)("button",{className:"genshin-button",children:"Import song"})})}),Object(B.jsxs)("div",{className:"tab-selector-wrapper",children:[Object(B.jsx)("button",{className:"recorded"===this.state.selectedSongType?"tab-selector tab-selected":"tab-selector",onClick:function(){return e.changeSelectedSongType("recorded")},children:"Recorded"}),Object(B.jsx)("button",{className:"composed"===this.state.selectedSongType?"tab-selector tab-selected":"tab-selector",onClick:function(){return e.changeSelectedSongType("composed")},children:"Composed"})]}),Object(B.jsx)("div",{className:"songs-wrapper",children:"recorded"===this.state.selectedSongType?c.map((function(e){return Object(B.jsx)(Y,{data:e,functions:o},e.name)})):l.map((function(e){return Object(B.jsx)(Y,{data:e,functions:o},e.name)}))})]}),Object(B.jsxs)(z,{title:"Settings",visible:n,children:[Object.entries(s.settings).map((function(e){var t=Object(F.a)(e,2),n=t[0],a=t[1];return Object(B.jsx)(q,{objKey:n,data:a,update:r},n+a.value)})),Object(B.jsx)("a",{className:"donate-button",href:"https://www.buymeacoffee.com/Specy",target:"_blank",children:"Support me"})]})]})]})}}]),n}(i.Component);function z(e){var t=e.visible===e.title?"menu-panel menu-panel-visible":"menu-panel";return Object(B.jsxs)("div",{className:t,children:[Object(B.jsx)("div",{className:"menu-title",children:e.title}),Object(B.jsx)("div",{className:"panel-content-wrapper",children:e.children})]})}function K(e){return Object(B.jsx)("div",{onClick:function(){return e.action(!1)},className:"close-menu menu-item",children:Object(B.jsx)(H.a,{icon:G.s,className:"icon"})})}function q(e){var t=e.data,n=e.update,a=e.objKey,s=Object(i.useState)(t.value),o=Object(F.a)(s,2),r=o[0],c=o[1];return"settingVesion"===a?null:Object(B.jsxs)("div",{className:"settings-row",children:[Object(B.jsx)("div",{children:t.name}),"select"===t.type?Object(B.jsx)("select",{value:t.value,onChange:function(e){var s=e.target.value;t.value=s,n({key:a,data:t})},children:t.options.map((function(e){return Object(B.jsx)("option",{value:e,children:e},e)}))}):Object(B.jsx)("input",{type:t.type,value:r,checked:r,onChange:function(e){var n=e.target,a="checkbox"===t.type?n.checked:n.value;"number"===t.type&&(a=Number(a),e.target.value="",a<t.threshold[0]||a>t.threshold[1])||c(a)},onBlur:function(){t.value!==r&&(t.value=r,n({key:a,data:t}))}})]})}function Y(e){var t=e.data,n=e.functions.removeSong,a=e.functions.playSong,s=e.functions.practiceSong,o=e.functions.toggleMenu,r=e.functions.downloadSong;return Object(B.jsxs)("div",{className:"song-row",children:[Object(B.jsx)("div",{className:"song-name",onClick:function(){a(t),o(!1)},children:t.name}),Object(B.jsxs)("div",{className:"song-buttons-wrapper",children:[Object(B.jsx)("button",{className:"song-button",onClick:function(){s(t),o(!1)},children:Object(B.jsx)(H.a,{icon:G.f})}),Object(B.jsx)("button",{className:"song-button",onClick:function(){return r(t)},children:Object(B.jsx)(H.a,{icon:G.g})}),Object(B.jsx)("button",{className:"song-button",onClick:function(){return n(t.name)},children:Object(B.jsx)(H.a,{icon:G.t,color:"#ed4557"})})]})]})}var Q=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){return Object(a.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"render",value:function(){var e=this,t=this.props.className?"menu-item ".concat(this.props.className):"menu-item";return Object(B.jsx)("div",{className:t,onClick:function(){return e.props.action(e.props.type)},children:this.props.children})}}]),n}(i.Component),X=J,Z=n(42),$=n.n(Z),ee=["lyre"],te={settingVesion:2,instrument:{name:"Instrument (Layer 1)",type:"select",songSetting:!1,value:0,options:ee},layer2:{name:"Instrument (Layer 2)",type:"select",songSetting:!1,value:0,options:ee},layer3:{name:"Instrument (Layer 3)",type:"select",songSetting:!1,value:0,options:ee},bpm:{name:"Bpm",type:"number",songSetting:!0,threshold:[0,1e3],value:220},beatMarks:{name:"Beat marks",type:"select",songSetting:!1,value:0,options:[0,3,4]},pitch:{name:"Pitch",type:"select",songSetting:!0,value:"C",options:["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"]},columnsPerCanvas:{name:"Number of visible columns",type:"select",songSetting:!1,value:35,options:[20,25,30,35,40,45,50]},caveMode:{name:"Reverb (cave mode)",type:"checkbox",songSetting:!1,value:!1}},ne={settingVesion:1,keyboardSize:{name:"Keyboard size",type:"number",songSetting:!1,value:100,threshold:[0,200]},instrument:{name:"Instrument",type:"select",songSetting:!1,value:0,options:["lyre"]},pitch:{name:"Pitch",type:"select",songSetting:!0,value:"C",options:["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"]},caveMode:{name:"Reverb (cave mode)",type:"checkbox",songSetting:!1,value:!1}};function ae(e){return se.apply(this,arguments)}function se(){return(se=Object(p.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=document.createElement("div");n.className="floating-prompt";var a=document.createElement("div");a.innerText=t;var s=document.createElement("input");s.type="text",s.placeholder="Write here",s.className="prompt-input";var o=document.createElement("div"),r=document.createElement("button"),i=document.createElement("button");r.className="prompt-button",i.className="prompt-button",o.className="prompt-row",i.innerText="Ok",r.innerText="Cancel",o.append(r,i),n.append(a,s,o),document.body.appendChild(n),r.addEventListener("click",(function(){n.classList.add("floating-prompt-hidden"),e(null),setTimeout((function(){return n.remove()}),200)})),i.addEventListener("click",(function(){n.classList.add("floating-prompt-hidden"),e(s.value),setTimeout((function(){return n.remove()}),200)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function oe(e){return re.apply(this,arguments)}function re(){return(re=Object(p.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){var n=document.createElement("div");n.className="floating-prompt";var a=document.createElement("div");a.innerText=t;var s=document.createElement("div"),o=document.createElement("button"),r=document.createElement("button");o.className="prompt-button",r.className="prompt-button",s.className="prompt-row",r.innerText="Yes",o.innerText="No",s.append(o,r),n.append(a,s),document.body.appendChild(n),o.addEventListener("click",(function(){n.classList.add("floating-prompt-hidden"),e(!1),setTimeout((function(){return n.remove()}),200)})),r.addEventListener("click",(function(){n.classList.add("floating-prompt-hidden"),e(!0),setTimeout((function(){return n.remove()}),200)}))})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ie=n.p+"static/media/rotate.e7c0f107.svg";function ce(e){var t="genshin-button "+(e.active?"selected":"");return Object(B.jsx)("button",{className:t,onClick:e.click,children:e.children})}var le=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var s;return Object(a.a)(this,n),(s=t.call(this,e)).getSettings=function(){var e=localStorage.getItem("Genshin_Main_Settings");try{e=JSON.parse(e)}catch(t){e=null}return null!==e?e.settingVesion!==ne.settingVesion?(s.updateSettings(ne),ne):e:ne},s.updateSettings=function(e){var t;t=void 0!==e?e:s.state.settings,localStorage.setItem("Genshin_Main_Settings",JSON.stringify(t))},s.handleSettingChange=function(e){var t=s.state.settings,n=e.data;t[e.key].value=n.value,"instrument"===e.key&&s.loadInstrument(n.value),s.setState({settings:t},s.updateSettings)},s.syncSongs=Object(p.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.dbCol.songs.find().toArray();case 2:t=e.sent,s.setState({songs:t});case 4:case"end":return e.stop()}}),e)}))),s.practiceSong=function(){var e=Object(p.a)(h.a.mark((function e(t){var n,a,o,r=arguments;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:0,e.next=3,s.stopSong();case 3:a=s.state.keyboardData.practicingSong,t.data.isComposedVersion&&(t=S(t),a.threshold=10),a.notes=t.notes,a.timestamp=(new Date).getTime(),(o=JSON.parse(JSON.stringify(s.state.keyboardData.practicingSong))).start=n,s.setState({keyboardData:s.state.keyboardData,thereIsSong:!0},(function(){var e=new CustomEvent("practiceSong",{detail:o});window.dispatchEvent(e)}));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.songExists=function(){var e=Object(p.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.dbCol.songs.findOne({name:t});case 2:return e.t0=e.sent,e.t1=void 0,e.abrupt("return",e.t0!==e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.addSong=function(){var e=Object(p.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.songExists(t.name);case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",new v("Warning","A song with this name already exists! \n"+t.name).trigger());case 4:return e.next=6,s.dbCol.songs.insert(t);case 6:s.syncSongs();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.removeSong=function(){var e=Object(p.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe('Are you sure you want to delete the song: "'.concat(t,'" ?'));case 2:e.sent&&s.dbCol.songs.remove({name:t},s.syncSongs);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.handleRecording=function(e){s.state.isRecording&&s.recording.addNote(e.index)},s.handleSliderEvent=function(e){s.changeSliderState({position:Number(e.target.value),size:s.state.sliderState.size})},s.stopSong=function(){return new Promise((function(e){s.setState({thereIsSong:!1,keyboardData:{practicingSong:new b([]),playingSong:new b([])}},(function(){var t=new CustomEvent("playSong",{detail:new b([])});window.dispatchEvent(t),t=new CustomEvent("practiceSong",{detail:new b([])}),window.dispatchEvent(t),e()}))}))},s.changeSliderState=function(e){s.setState({sliderState:e})},s.playSong=function(){var e=Object(p.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.stopSong();case 2:t.data.isComposedVersion&&(t=S(t)),n={timestamp:(new Date).getTime(),notes:t.notes},s.state.keyboardData.playingSong=n,s.setState({keyboardData:s.state.keyboardData,thereIsSong:!0}),a=new CustomEvent("playSong",{detail:n}),window.dispatchEvent(a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.toggleRecord=function(){var e=Object(p.a)(h.a.mark((function e(t){var n,a,o,r,i,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("boolean"!==typeof t&&(t=void 0),(n=void 0!==t?t:!s.state.isRecording)||!(s.recording.notes.length>0)){e.next=27;break}o="Write song name, press cancel to ignore";case 4:return e.next=7,ae(o);case 7:if(null!==(a=e.sent)){e.next=10;break}return e.abrupt("break",23);case 10:if(""===a){e.next=20;break}return e.next=13,s.songExists(a);case 13:if(!e.sent){e.next=17;break}o="This song already exists: "+a,e.next=18;break;case 17:return e.abrupt("break",23);case 18:e.next=21;break;case 20:o="Write song name, press cancel to ignore";case 21:e.next=4;break;case 23:r=new f(a,s.recording.notes),null!==a&&s.addSong(r),e.next=31;break;case 27:s.recording=new m,i=new b([]),c=new CustomEvent("playSong",{detail:i}),window.dispatchEvent(c);case 31:s.state.isRecording=n,s.setState({open:s.state.isRecording});case 33:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.db=new $.a.Db("Genshin",{songs:[]}),s.recording=new m,s.dbCol={songs:s.db.collection("songs")},s.state={keyboardData:{instrument:"lyre",playingSong:{timestamp:0,notes:[]},practicingSong:{timestamp:0,notes:[],threshold:100}},isRecording:!1,songs:[],settings:s.getSettings(),sliderState:{position:0,size:0},thereIsSong:!1},s.syncSongs(),s}return Object(s.a)(n,[{key:"componentDidCatch",value:function(){new v("Warning","There was an error with the song! Restoring default...").trigger(),this.stopSong()}},{key:"render",value:function(){var e=this,t=this.state,n={handleRecording:this.handleRecording,changeSliderState:this.changeSliderState,stopSong:this.stopSong},a={addSong:this.addSong,removeSong:this.removeSong,playSong:this.playSong,practiceSong:this.practiceSong,stopSong:this.stopSong,changePage:this.props.changePage,handleSettingChange:this.handleSettingChange},s={songs:t.songs,settings:this.state.settings};return Object(B.jsxs)("div",{className:"app",children:[Object(B.jsxs)("div",{className:"rotate-screen",children:[Object(B.jsx)("img",{src:ie}),"For a better experience, add the website to the home screen, and rotate your device"]}),Object(B.jsx)(X,{functions:a,data:s}),Object(B.jsxs)("div",{className:"right-panel",children:[Object(B.jsx)("div",{className:"upper-right",children:Object(B.jsx)(ce,{active:t.isRecording,click:this.toggleRecord,children:t.isRecording?"Stop":"Record"})}),Object(B.jsxs)("div",{className:"keyboard-wrapper",children:[Object(B.jsxs)("div",{className:this.state.thereIsSong?"slider-wrapper":"slider-wrapper hidden-opacity",children:[Object(B.jsx)("button",{className:"song-button",onClick:this.stopSong,children:Object(B.jsx)(H.a,{icon:G.q})}),Object(B.jsx)("input",{type:"range",className:"slider",min:0,onChange:this.handleSliderEvent,max:t.sliderState.size,value:t.sliderState.position}),Object(B.jsx)("button",{className:"song-button",onClick:function(){return e.practiceSong(t.keyboardData.practicingSong,t.sliderState.position)},children:Object(B.jsx)(H.a,{icon:G.r})})]}),Object(B.jsx)(V,{data:t.keyboardData,settings:this.state.settings,functions:n,isRecording:t.isRecording})]})]})]})}}]),n}(i.Component),ue=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var s;return Object(a.a)(this,n),(s=t.call(this,e)).toggleMenu=function(e){"boolean"!==typeof e&&(e=void 0);var t=void 0!==e?e:!s.state.open;s.setState({open:t}),!1===t&&s.props.functions.toggleMenuVisible()},s.changeSelectedSongType=function(e){s.setState({selectedSongType:e})},s.selectSideMenu=function(e){if(e===s.state.selectedMenu&&s.state.open)return s.setState({open:!1});s.setState({selectedMenu:e,open:!0})},s.downloadSong=function(e){e._id&&delete e._id;var t=JSON.stringify(e);(new j).download(t,e.name+".json")},s.state={open:!1,selectedMenu:"Settings",selectedSongType:"composed"},s}return Object(s.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.data,a=t.functions,s=this.state.open?"side-menu menu-open":"side-menu",o=this.state.selectedMenu,r=a.loadSong,i=a.removeSong,c=a.updateSong,l=a.changePage,u=a.handleSettingChange,d={loadSong:r,removeSong:i,toggleMenu:this.toggleMenu},h=n.songs.filter((function(e){var t;return!(null===(t=e.data)||void 0===t?void 0:t.isComposedVersion)})),p=n.songs.filter((function(e){var t;return null===(t=e.data)||void 0===t?void 0:t.isComposedVersion})),g=n.hasChanges?"margin-top-auto not-saved":"margin-top-auto",m=n.menuOpen?"menu menu-visible":"menu";return Object(B.jsxs)("div",{className:"menu-wrapper",children:[Object(B.jsxs)("div",{className:m,children:[Object(B.jsx)(he,{action:this.toggleMenu}),Object(B.jsx)(me,{type:"Save",action:function(){return c(n.currentSong)},className:g,children:Object(B.jsx)(H.a,{icon:G.n,className:"icon"})}),Object(B.jsx)(me,{type:"Songs",action:this.selectSideMenu,children:Object(B.jsx)(H.a,{icon:G.i,className:"icon"})}),Object(B.jsx)(me,{type:"Settings",action:this.selectSideMenu,children:Object(B.jsx)(H.a,{icon:G.d,className:"icon"})}),Object(B.jsx)(me,{type:"Composer",action:function(){return l("App")},className:"inverted",children:Object(B.jsx)(H.a,{icon:G.e,className:"icon"})})]}),Object(B.jsxs)("div",{className:s,children:[Object(B.jsx)(de,{title:"No selection",visible:o}),Object(B.jsxs)(de,{title:"Songs",visible:o,children:[Object(B.jsx)("div",{className:"songs-buttons-wrapper",children:Object(B.jsx)("button",{className:"genshin-button",onClick:this.props.functions.createNewSong,children:"Create new song"})}),Object(B.jsxs)("div",{className:"tab-selector-wrapper",children:[Object(B.jsx)("button",{className:"recorded"===this.state.selectedSongType?"tab-selector tab-selected":"tab-selector",onClick:function(){return e.changeSelectedSongType("recorded")},children:"Recorded"}),Object(B.jsx)("button",{className:"composed"===this.state.selectedSongType?"tab-selector tab-selected":"tab-selector",onClick:function(){return e.changeSelectedSongType("composed")},children:"Composed"})]}),Object(B.jsx)("div",{className:"songs-wrapper no-margin",children:"recorded"===this.state.selectedSongType?h.map((function(e){return Object(B.jsx)(pe,{data:e,functions:d},e.name)})):p.map((function(e){return Object(B.jsx)(pe,{data:e,functions:d},e.name)}))})]}),Object(B.jsxs)(de,{title:"Settings",visible:o,children:[Object.entries(n.settings).map((function(e){var t=Object(F.a)(e,2),n=t[0],a=t[1];return Object(B.jsx)(ge,{objKey:n,data:a,update:u},n+a.value)})),Object(B.jsx)("a",{className:"donate-button",href:"https://www.buymeacoffee.com/Specy",target:"_blank",children:"Support me"})]})]})]})}}]),n}(i.Component);function de(e){var t=e.visible===e.title?"menu-panel menu-panel-visible":"menu-panel";return Object(B.jsxs)("div",{className:t,children:[Object(B.jsx)("div",{className:"menu-title",children:e.title}),Object(B.jsx)("div",{className:"panel-content-wrapper",children:e.children})]})}function he(e){return Object(B.jsx)("div",{onClick:function(){return e.action(!1)},className:"close-menu menu-item",children:Object(B.jsx)(H.a,{icon:G.s,className:"icon"})})}function pe(e){var t=e.data,n=e.functions,a=n.removeSong,s=n.toggleMenu,o=n.loadSong;return Object(B.jsxs)("div",{className:"song-row",children:[Object(B.jsx)("div",{className:"song-name",onClick:function(){o(t),s(!1)},children:t.name}),Object(B.jsx)("div",{className:"song-buttons-wrapper",children:Object(B.jsx)("button",{className:"song-button",onClick:function(){return a(t.name)},children:Object(B.jsx)(H.a,{icon:G.t,color:"#ed4557"})})})]})}function ge(e){var t=e.data,n=e.update,a=e.objKey,s=Object(i.useState)(t.value),o=Object(F.a)(s,2),r=o[0],c=o[1];return"settingVesion"===a?null:Object(B.jsxs)("div",{className:"settings-row",children:[Object(B.jsx)("div",{children:t.name}),"select"===t.type?Object(B.jsx)("select",{value:t.value,onChange:function(e){var s=e.target.value;t.value=s,n({key:a,data:t})},children:t.options.map((function(e){return Object(B.jsx)("option",{value:e,children:e},e)}))}):Object(B.jsx)("input",{type:t.type,value:r,checked:r,onChange:function(e){var n=e.target,a="checkbox"===t.type?n.checked:n.value;"number"===t.type&&(a=Number(a),e.target.value="",a<t.threshold[0]||a>t.threshold[1])||c(a)},onBlur:function(){t.value!==r&&(t.value=r,n({key:a,data:t}))}})]})}var me=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){return Object(a.a)(this,n),t.call(this,e)}return Object(s.a)(n,[{key:"render",value:function(){var e=this,t=this.props.className?"menu-item ".concat(this.props.className):"menu-item";return Object(B.jsx)("div",{className:t,onClick:function(){return e.props.action(e.props.type)},children:this.props.children})}}]),n}(i.Component),fe=ue,ve=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var s;return Object(a.a)(this,n),(s=t.call(this,e)).state={},s}return Object(s.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return this.props.layers!==e.layers}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,a=t.layers,s="note-composer ",o=L()()?n.noteNames.mobile:n.noteNames.keyboard;return"1"===a[0]&&(s+=" layer-1"),"1"===a[1]&&(s+=" layer-2"),"1"===a[2]&&(s+=" layer-3"),Object(B.jsx)("button",{onPointerDown:function(){return e.props.clickAction(n)},className:"button-hitbox",children:Object(B.jsxs)("div",{className:s,children:[Object(B.jsx)("img",{alt:n.noteNames.mobile,src:"./assets/icons/keys/".concat(n.noteNames.mobile,".svg")}),Object(B.jsx)("div",{className:"layer-3-ball"}),Object(B.jsx)("div",{className:"note-name",children:o})]})})}}]),n}(i.Component),be=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var s;return Object(a.a)(this,n),(s=t.call(this,e)).state={},s}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props;return Object(B.jsx)(B.Fragment,{children:e.options.map((function(t){return Object(B.jsx)("button",{style:{backgroundColor:t===e.selected?e.selectedColor:""},className:e.buttonsClass,onClick:function(){return e.onSelect(t)},children:t})}))})}}]),n}(i.Component),je=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var s;return Object(a.a)(this,n),(s=t.call(this,e)).state={},s}return Object(s.a)(n,[{key:"render",value:function(){var e=this.props,t=e.data,n=e.functions,a=t.currentColumn.notes.map((function(e){return e.index}));return Object(B.jsxs)("div",{children:[Object(B.jsx)("div",{className:"keyboard",children:t.keyboard.layout.map((function(e,s){var o=a.indexOf(s);return Object(B.jsx)(ve,{layers:o>=0?t.currentColumn.notes[o].layer:"000",data:e,clickAction:n.handleClick},e.index)}))}),Object(B.jsxs)("div",{className:"bottom-right-wrapper",children:[Object(B.jsxs)("div",{className:"layer-buttons-wrapper",children:[Object(B.jsx)("div",{className:"bottom-right-text",children:"Layer"}),Object(B.jsx)(be,{buttonsClass:"layer-button",selectedColor:"#63aea7",options:[1,2,3],onSelect:n.changeLayer,selected:t.layer})]}),Object(B.jsxs)("div",{className:"tempo-changers-wrapper",children:[Object(B.jsx)("div",{className:"bottom-right-text",children:"Tempo"}),t.TempoChangers.map((function(e){return Object(B.jsx)("button",{onClick:function(){return n.handleTempoChanger(e)},style:{backgroundColor:"#"+e.color.toString(16)},children:e.text},e.id)}))]})]})]})}}]),n}(i.Component),xe=n(21),ye=n(11),we="#d3bd8e",Se="#de4545",Oe="#de4545",ke=[{color:5332079},{color:4739939},{color:1742475}],Ce=["000","001","010","011","100","101","110","111"],Ne=[{type:"short",color:"#c44350"},{type:"long",color:"#c44350"}],Ee=function e(t,n){var s=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;Object(a.a)(this,e),this.generate=function(){x.forEach((function(e){var t=Te(e,s,1);s.cache.columns.push(t.toDataURL())})),ke.forEach((function(e){var t=Te(e,s,1);s.cache.standard.push(t.toDataURL())})),ke.forEach((function(e){var t=Te(e,s,3);s.cache.standardLarger.push(t.toDataURL())})),Ce.forEach((function(e){var t=s.noteWidth>20?4:2,n=document.createElement("canvas");n.height=s.noteHeight,n.width=s.noteWidth;var a=n.getContext("2d");"1"===e[0]&&(a.fillStyle=we,Pe(a,s.margin/2,s.margin/2,s.noteWidth-s.margin-1,s.noteHeight-s.margin-1,t,!0,!1)),"1"===e[1]&&(a.strokeStyle=Se,a.lineWidth=2,Pe(a,s.margin/2,s.margin/2,s.noteWidth-s.margin-1,s.noteHeight-s.margin-1,t,!1,!0)),"1"===e[2]&&(a.beginPath(),a.fillStyle=Oe,a.arc(s.noteWidth/2-.5,s.noteHeight/2-.5,s.noteHeight/5,0,2*Math.PI),a.fill()),s.cache.notes[e]=n.toDataURL()})),x.forEach((function(e){var t=Te(e,s,2);s.cache.columnsLarger.push(t.toDataURL())})),Ne.forEach((function(e){var t=document.createElement("canvas");if("short"===e.type){var n=s.timelineHeight/6;t.height=s.timelineHeight,t.width=2*n;var a=t.getContext("2d");a.fillStyle=e.color,a.arc(n,s.timelineHeight/2,n,0,2*Math.PI),a.fill(),s.cache.breakpoints.push(t.toDataURL())}else{t.height=s.height,t.width=s.width;var o=s.width/4,r=t.getContext("2d");r.fillStyle=e.color;var i=s.width/2-s.margin/4;r.arc(i,0,o,0,2*Math.PI),r.arc(i,s.height,o,0,2*Math.PI),r.fill(),s.cache.breakpoints.push(t.toDataURL())}}))},this.width=t,this.height=n,this.cache={columns:[],notes:{},standard:[],columnsLarger:[],standardLarger:[],breakpoints:[]},this.notesFigures=[],this.timelineHeight=r,this.margin=o,this.noteWidth=this.width,this.noteHeight=this.height/21,this.app=new ye.b({width:t,height:n}),this.generate()};function Te(e,t,n){var a=document.createElement("canvas");a.height=t.height,a.width=t.width;var s=a.getContext("2d");s.fillStyle="#"+e.color.toString(16),s.fillRect(0,0,t.width,t.height),s.strokeStyle=2===n?"black":"#333333",s.lineWidth=n,s.beginPath(),s.moveTo(t.width,0),s.lineTo(t.width,t.height),s.stroke(),s.strokeStyle="#333333";for(var o=1;o<3;o++){s.lineWidth=1;var r=7*t.noteHeight*o;s.moveTo(0,r),s.lineTo(t.width,r)}return s.stroke(),a}function Pe(e,t,n,a,s,o,r,i){if("undefined"===typeof i&&(i=!0),"undefined"===typeof o&&(o=5),"number"===typeof o)o={tl:o,tr:o,br:o,bl:o};else{var c={tl:0,tr:0,br:0,bl:0};for(var l in c)o[l]=o[l]||c[l]}e.beginPath(),e.moveTo(t+o.tl,n),e.lineTo(t+a-o.tr,n),e.quadraticCurveTo(t+a,n,t+a,n+o.tr),e.lineTo(t+a,n+s-o.br),e.quadraticCurveTo(t+a,n+s,t+a-o.br,n+s),e.lineTo(t+o.bl,n+s),e.quadraticCurveTo(t,n+s,t,n+s-o.bl),e.lineTo(t,n+o.tl),e.quadraticCurveTo(t,n,t+o.tl,n),e.closePath(),r&&e.fill(),i&&e.stroke()}n(176);var Me=35,Ae=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var s;Object(a.a)(this,n),(s=t.call(this,e)).resetPointerDown=function(e){s.stageSelected=!1,s.sliderSelected=!1,s.stagePreviousPositon=0},s.handleWheel=function(e){e.deltaY<0?s.props.functions.selectColumn(s.props.data.selected-1,!0):s.props.functions.selectColumn(s.props.data.selected+1,!0)},s.handleClick=function(e,t){var n=e.data.global.x;if("click"===t){var a=s.state.column.width*s.props.data.columns.length,o=Math.floor(n/s.state.width*a/s.state.column.width);s.props.functions.selectColumn(o)}"up"===t&&(s.sliderSelected=!1),"down"===t&&(s.sliderSelected=!0),"downStage"===t&&(s.stagePreviousPositon=n,s.stageSelected=!0)},s.handleStageSlide=function(e){var t=e.data.global.x;if(!0===s.stageSelected){if(s.throttleStage++,s.throttleStage<4)return;s.throttleStage=0;var n=s.stagePreviousPositon<t,a=Math.floor(Math.abs(s.stagePreviousPositon-t)/4);a>4&&(a=4);var o=n?-1:1;if(s.stagePreviousPositon=t,s.props.data.selected===s.props.data.selected+o*a)return;s.props.functions.selectColumn(s.props.data.selected+o*a,!0)}},s.handleBreakpoints=function(e){var t,n=s.props.data.selected,a=s.props.data.columns,o=s.props.data.breakpoints;(t=1===e?o.filter((function(e){return e>n})).sort((function(e,t){return e-t})):o.filter((function(e){return e<n})).sort((function(e,t){return t-e}))).length>=0&&a.length>=t[0]&&t[0]>=0&&s.props.functions.selectColumn(t[0])},s.handleSlide=function(e){if(s.sliderSelected){if(s.throttleStage++,s.throttleStage<4)return;s.throttleStage=0;var t=s.state.column.width*s.props.data.columns.length,n=e.data.global.x,a=Math.floor(n/s.state.width*t/s.state.column.width);s.props.functions.selectColumn(a,!0)}},Me=Number(s.props.data.settings.columnsPerCanvas.value);var o,r=Re(.82*window.screen.width),i=Re(.45*window.screen.height);window.screen.width<window.screen.height&&(r=Re(.82*window.screen.height),i=Re(.45*window.screen.width)),s.state={width:r,height:i,column:{width:(o=Re(r),Re(o/Me)),height:i},timelineHeight:L()()?25:30,currentBreakpoint:-1},s.canvasRef=c.a.createRef();var l=L()()?1:4;return s.cache=new Ee(s.state.column.width,i,l,s.state.timelineHeight).cache,s.stageSelected=!1,s.sliderSelected=!1,s.stagePreviousPositon=0,s.throttleStage=0,s}return Object(s.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("pointerup",this.resetPointerDown),this.canvasRef.current._canvas.addEventListener("wheel",this.handleWheel)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("pointerup",this.resetPointerDown),this.canvasRef.current._canvas.removeEventListener("wheel",this.handleWheel)}},{key:"render",value:function(){var e=this,t=this.state,n=this.props,a=n.data,s=n.functions,o=this.state.column,r=(a.selected-Me/2+1)*-o.width,i=this.state.timelineHeight,c=0,l=!1,u=this.cache,d=Number(a.settings.beatMarks.value),h=0===d?14:5*d-1,p=this.state.width/a.columns.length,g=Math.floor(p*(Me+1));g>this.state.width&&(g=this.state.width);var m=p*a.selected-(Me/2-1)*p;return Object(B.jsxs)("div",{className:"canvas-wrapper",style:{width:t.width+6},children:[Object(B.jsx)(xe.Stage,{width:t.width,height:t.height,options:{backgroundColor:4805734},ref:this.canvasRef,children:Object(B.jsx)(xe.Container,{anchor:[.5,.5],x:r,interactive:!0,pointerdown:function(t){return e.handleClick(t,"downStage")},pointermove:function(t){return e.handleStageSlide(t)},children:a.columns.map((function(t,n){if(c>h&&(l=!l,c=0),c++,!function(e,t){var n=Me/2+2,a=[t-n,t+n];return a[0]<e&&e<a[1]}(n,a.selected))return null;var r=(n+1)%d===0?u.columnsLarger:u.columns,i=(n+1)%d===0?u.standardLarger:u.standard,p=i[Number(l)],g=0===t.tempoChanger?p:r[t.tempoChanger];return g=a.selected===n?i[2]:g,Object(B.jsx)(De,{cache:u,data:t,index:n,sizes:o,backgroundCache:g,click:s.selectColumn,isSelected:n===a.selected,isBreakpoint:e.props.data.breakpoints.includes(n)},n)}))})},this.state.width),Object(B.jsxs)("div",{className:"timeline-wrapper",style:{height:this.state.timelineHeight},children:[Object(B.jsx)("div",{className:"timeline-button",onClick:function(){return e.handleBreakpoints(-1)},children:Object(B.jsx)(H.a,{icon:G.o})}),Object(B.jsx)("div",{className:"timeline-button",onClick:function(){return e.handleBreakpoints(1)},children:Object(B.jsx)(H.a,{icon:G.p})}),Object(B.jsxs)(xe.Stage,{width:t.width,height:i,options:{antialias:!0,autoDensity:!0},children:[Object(B.jsxs)(xe.Container,{width:this.state.width,height:this.state.timelineHeight,interactive:!0,pointertap:function(t){return e.handleClick(t,"click")},pointerdown:function(t){return e.handleClick(t,"down")},pointerup:function(t){return e.handleClick(t,"up")},pointermove:this.handleSlide,children:[Object(B.jsx)(xe.Graphics,{draw:function(t){var n,a,s;n=t,a=e.state.width,s=e.state.timelineHeight,n.clear(),n.beginFill(5332079,1),n.drawRect(0,0,a,s)}}),a.breakpoints.map((function(e){return Object(B.jsx)(xe.Sprite,{image:u.breakpoints[0],x:p*e})}))]}),Object(B.jsx)(xe.Graphics,{draw:function(t){return n=t,a=g,s=e.state.timelineHeight,n.clear(),n.lineStyle(3,1742475,.8),void n.drawRoundedRect(0,0,a-2,s-4,6);var n,a,s},x:m,y:2})]}),Object(B.jsx)("div",{className:"timeline-button",onClick:s.toggleBreakpoint,children:Object(B.jsx)(H.a,{icon:a.breakpoints.includes(a.selected)?G.h:G.m})})]})]})}}]),n}(i.Component);function De(e){var t=e.data,n=e.index,a=e.sizes,s=e.click,o=e.cache,r=e.backgroundCache,i=e.isBreakpoint;return Object(B.jsxs)(xe.Container,{pointertap:function(){return s(n)},interactive:!0,x:a.width*n,children:[Object(B.jsx)(xe.Sprite,{image:r,interactiveChildren:!1}),t.notes.map((function(e){return Object(B.jsx)(xe.Sprite,{image:o.notes[e.layer],y:Le[e.index]*a.height/21},e.index)})),i?Object(B.jsx)(xe.Sprite,{image:o.breakpoints[1]}):null]})}function Re(e){return 2*Math.round(e/2)}var Le=[14,15,16,17,18,19,20,7,8,9,10,11,12,13,0,1,2,3,4,5,6].reverse(),Be=Ae,Ie=n.p+"static/media/addCell.0252d665.svg",We=n.p+"static/media/removeCell.caa23d0c.svg";function Ue(e){var t=Math.floor(e/6e4),n=(e%6e4/1e3).toFixed(0);return t+":"+(n<10?"0":"")+n}function Ve(e,t){var n=e.columns,a=Math.floor(6e4/e.bpm),s=0;return n.forEach((function(e,n){n>t||(s+=a*x[e.tempoChanger].changer)})),s}function Fe(e){return new Promise((function(t){setTimeout(t,e)}))}function He(e,t,n){return t>=e.length?e.valueOf():e.substring(0,t)+n+e.substring(t+1)}var Ge=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var s;Object(a.a)(this,n),(s=t.call(this,e)).getSettings=function(){var e=localStorage.getItem("Genshin_Composer_Settings");try{e=JSON.parse(e)}catch(t){e=null}return null!==e?e.settingVesion!==te.settingVesion?(s.updateSettings(te),te):e:te},s.updateSettings=function(e){var t;t=void 0!==e?e:s.state.settings,localStorage.setItem("Genshin_Composer_Settings",JSON.stringify(t))},s.handleSettingChange=function(e){var t=s.state.settings,n=e.data;t[e.key].value=n.value,n.songSetting&&(s.state.song[e.key]=n.value),"instrument"===e.key&&s.loadInstrument(n.value,1),"layer2"===e.key&&s.loadInstrument(n.value,2),"layer3"===e.key&&s.loadInstrument(n.value,3),s.setState({settings:t,song:s.state.song},(function(){s.updateSettings(),n.songSetting&&s.updateSong(s.state.song)}))},s.loadInstrument=function(){var e=Object(p.a)(h.a.mark((function e(t,n){var a,o,r;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(1!==n){e.next=7;break}return a=new D(t),e.next=4,a.load(s.state.audioContext);case 4:s.setState({instrument:a}),e.next=13;break;case 7:return o=new D(t),(r=s.state.layers)[n-2]=o,e.next=12,r[n-2].load(s.state.audioContext);case 12:s.setState({layers:r});case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),s.handleKeyboard=function(e){var t=e.key.toUpperCase();if("INPUT"!==document.activeElement.tagName)switch(t){case"D":s.selectColumn(s.state.song.selected+1);break;case"A":s.selectColumn(s.state.song.selected-1);break;case"1":s.handleTempoChanger(x[0]);break;case"2":s.handleTempoChanger(x[1]);break;case"3":s.handleTempoChanger(x[2]);break;case"4":s.handleTempoChanger(x[3]);break;case" ":s.togglePlay()}},s.playSound=function(e){var t=s.state.audioContext.createBufferSource();t.buffer=e.buffer,t.playbackRate.value=P(s.state.settings.pitch.value),s.state.settings.caveMode.value?t.connect(s.state.reverbAudioContext):t.connect(s.state.audioContext.destination),t.start(0)},s.handleClick=function(e){var t=s.state.song.columns[s.state.song.selected],n=t.notes.findIndex((function(t){return e.index===t.index})),a=s.state.layer-1;if(n<0){var o=new E(e.index);o.layer=He(o.layer,a,"1"),t.notes.push(o)}else{var r=t.notes[n];r.layer=He(r.layer,a,"0"===r.layer[a]?"1":"0"),"000"===r.layer&&t.notes.splice(n,1)}s.setState({song:s.state.song}),s.hasChanges=!0,s.playSound(e)},s.syncSongs=Object(p.a)(h.a.mark((function e(){var t;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.dbCol.songs.find().toArray();case 2:t=(t=e.sent).map((function(e){return e.data.isComposedVersion?w(e):e})),s.setState({composedSongs:t,songs:t});case 5:case"end":return e.stop()}}),e)}))),s.addSong=function(){var e=Object(p.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.songExists(t.name);case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",new v("Warning","A song with this name already exists! \n"+t.name).trigger());case 4:return e.next=6,s.dbCol.songs.insert(O(t));case 6:s.syncSongs();case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.updateSong=function(){var e=Object(p.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Untitled"!==t.name){e.next=8;break}return e.next=3,s.askForSongName();case 3:if(null!==(n=e.sent)){e.next=6;break}return e.abrupt("return");case 6:return t.name=n,e.abrupt("return",s.addSong(t));case 8:return e.abrupt("return",new Promise(function(){var e=Object(p.a)(h.a.mark((function e(n){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.songExists(t.name);case 2:if(!e.sent){e.next=10;break}return e.next=5,s.dbCol.songs.update({name:t.name},O(t));case 5:console.log("song saved:",t.name),s.hasChanges=!1,s.syncSongs(),e.next=13;break;case 10:console.log("song doesn't exist"),t.name="Untitled",s.updateSong(t);case 13:n();case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.askForSongName=function(){return new Promise(function(){var e=Object(p.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="Write song name, press cancel to ignore";case 1:return e.next=4,ae(n);case 4:if(null!==(a=e.sent)){e.next=7;break}return e.abrupt("return",t(null));case 7:if(""===a){e.next=17;break}return e.next=10,s.songExists(a);case 10:if(!e.sent){e.next=14;break}n="This song already exists: "+a,e.next=15;break;case 14:return e.abrupt("return",t(a));case 15:e.next=18;break;case 17:n="Write song name, press cancel to ignore";case 18:e.next=1;break;case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},s.askForSongUpdate=function(){return new Promise(function(){var e=Object(p.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,oe('You have unsaved changes to the song: "'.concat(s.state.song.name,'" do you want to save now?'));case 2:n=e.sent,t(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},s.songExists=function(){var e=Object(p.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.dbCol.songs.findOne({name:t});case 2:return e.t0=e.sent,e.t1=void 0,e.abrupt("return",e.t0!==e.t1);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.createNewSong=Object(p.a)(h.a.mark((function e(){var t,n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Untitled"===s.state.song.name||!s.hasChanges){e.next=7;break}return e.next=3,s.askForSongUpdate();case 3:if(!e.sent){e.next=7;break}return e.next=7,s.updateSong(s.state.song);case 7:return e.next=9,s.askForSongName();case 9:if(null!==(t=e.sent)){e.next=12;break}return e.abrupt("return");case 12:n=new y(t),s.hasChanges=!1,s.setState({song:n},(function(){return s.addSong(n)}));case 15:case"end":return e.stop()}}),e)}))),s.removeSong=function(e){s.dbCol.songs.remove({name:e},s.syncSongs)},s.loadSong=function(){var e=Object(p.a)(h.a.mark((function e(t){var n,a;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.data.isComposedVersion||((t=C(t)).name+=" - Composed"),!((n=s.state.song).notes.length>0)){e.next=5;break}return e.next=5,s.updateSong(n);case 5:(a=s.state.settings).bpm.value=t.bpm,a.pitch.value=t.pitch,s.hasChanges=!1,s.setState({song:t,settings:a});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.addColumns=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"end",n=new Array(e).fill().map((function(){return new N})),a=s.state.song.columns;"end"===t?a.push.apply(a,Object(g.a)(n)):a.splice.apply(a,[t+1,0].concat(Object(g.a)(n))),1===e&&s.selectColumn(s.state.song.selected+1),s.hasChanges=!0,s.setState({song:s.state.song})},s.removeColumns=function(e,t){var n=s.state.song;n.columns.length<16||(n.columns.splice(t,e),n.columns.length<=n.selected&&s.selectColumn(n.selected-1),s.hasChanges=!0,s.setState({song:n}))},s.togglePlay=function(){var e=Object(p.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n="boolean"===typeof t?t:!s.state.isPlaying,s.setState({isPlaying:n},Object(p.a)(h.a.mark((function e(){var t,n,a,o,r,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.selectColumn(s.state.song.selected);case 1:if(!s.state.isPlaying){e.next=12;break}return n=s.state,a=n.song,o=n.settings,r=x[null===(t=a.columns[a.selected])||void 0===t?void 0:t.tempoChanger],i=Math.floor(6e4/o.bpm.value*(null===r||void 0===r?void 0:r.changer)),e.next=8,Fe(i);case 8:s.previousTime=(new Date).getTime(),s.handleTick(),e.next=1;break;case 12:case"end":return e.stop()}}),e)}))));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.handleTick=function(){var e=s.state.song.selected+1;if(s.state.isPlaying&&e>s.state.song.columns.length-1)return s.togglePlay(!1);s.selectColumn(s.state.song.selected+1)},s.toggleMenuVisible=function(){s.setState({menuOpen:!s.state.menuOpen})},s.toggleBreakpoint=function(){var e=s.state.song,t=e.selected,n=e.breakpoints.indexOf(t);n>=0&&e.columns.length>t?e.breakpoints.splice(n,1):e.columns.length>t&&e.breakpoints.push(t),s.setState({song:e})},s.handleTempoChanger=function(e){var t=s.state.song;t.columns[s.state.song.selected].tempoChanger=e.id,s.hasChanges=!0,s.setState({song:t})},s.selectColumn=function(e,t){var n=s.state,a=n.song;if(!(e<0||e>a.columns.length-1)){var o=n.instrument.layout,r=n.layers.map((function(e){return e.layout})),i=n.song.columns[e];a.selected=e,s.setState({song:a}),t||i.notes.forEach((function(e){"1"===e.layer[0]&&s.playSound(o[e.index]),"1"===e.layer[1]&&s.playSound(r[0][e.index]),"1"===e.layer[2]&&s.playSound(r[1][e.index])}))}},s.changeLayer=function(e){s.setState({layer:e})},s.db=new $.a.Db("Genshin",{songs:[]}),s.dbCol={songs:s.db.collection("songs")};var o=s.getSettings();s.playbackInterval=void 0,s.state={instrument:new D,layers:[new D,new D],audioContext:new(window.AudioContext||window.webkitAudioContext),reverbAudioContext:new(window.AudioContext||window.webkitAudioContext),songs:[],isPlaying:!1,song:new y("Untitled"),settings:o,menuOpen:!1,layer:1},s.hasChanges=!1,s.syncSongs(),s.loadInstrument("lyre",1),s.loadInstrument("lyre",2),s.loadInstrument("lyre",3);try{s.loadReverb()}catch(r){console.log("Error with reverb")}return s.previousTime=(new Date).getTime(),s}return Object(s.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("keydown",this.handleKeyboard)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.handleKeyboard)}},{key:"componentDidCatch",value:function(){this.setState({song:new y("Untitled")}),new v("Warning","There was an error with the song! Restoring default...").trigger()}},{key:"loadReverb",value:function(){var e=this,t=this.state.audioContext;fetch("./assets/audio/reverb4.wav").then((function(e){return e.arrayBuffer().catch((function(){console.log("Error with reverb ")}))})).then((function(n){return t.decodeAudioData(n,(function(n){var a=t.createConvolver(),s=t.createGain();s.gain.value=2.5,a.buffer=n,a.connect(s),s.connect(t.destination),e.setState({reverbAudioContext:a})}))})).catch((function(){console.log("Error with reverb")}))}},{key:"render",value:function(){var e=this,t=this.state,n=this.props,a=t.song,s={songs:t.songs,currentSong:t.song,settings:t.settings,hasChanges:this.hasChanges,menuOpen:t.menuOpen},o={loadSong:this.loadSong,removeSong:this.removeSong,createNewSong:this.createNewSong,changePage:n.changePage,updateSong:this.updateSong,handleSettingChange:this.handleSettingChange,toggleMenuVisible:this.toggleMenuVisible},r={handleClick:this.handleClick,handleTempoChanger:this.handleTempoChanger,changeLayer:this.changeLayer},i={keyboard:t.instrument,currentColumn:t.song.columns[t.song.selected],TempoChangers:x,layer:t.layer},c={selectColumn:this.selectColumn,toggleBreakpoint:this.toggleBreakpoint},l={columns:a.columns,selected:a.selected,settings:t.settings,breakpoints:t.song.breakpoints};return Object(B.jsxs)("div",{className:"app",children:[Object(B.jsx)("div",{className:"hamburger",onClick:this.toggleMenuVisible,children:Object(B.jsx)(H.a,{icon:G.a})}),Object(B.jsxs)("div",{className:"rotate-screen",children:[Object(B.jsx)("img",{src:ie}),"For a better experience, add the website to the home screen, and rotate your device"]}),Object(B.jsxs)("div",{className:"right-panel-composer",children:[Object(B.jsx)("div",{className:"column fill-x",children:Object(B.jsxs)("div",{className:"top-panel-composer",children:[Object(B.jsxs)("div",{className:"buttons-composer-wrapper",children:[Object(B.jsx)("div",{className:"tool",onClick:function(){return e.selectColumn(a.selected+1)},children:Object(B.jsx)(H.a,{icon:G.c})}),Object(B.jsx)("div",{className:"tool",onClick:function(){return e.selectColumn(a.selected-1)},children:Object(B.jsx)(H.a,{icon:G.b})}),Object(B.jsx)("div",{className:"tool",onClick:this.togglePlay,children:Object(B.jsx)(H.a,{icon:this.state.isPlaying?G.j:G.k})})]}),Object(B.jsx)(Be,{functions:c,data:l},this.state.settings.columnsPerCanvas.value),Object(B.jsxs)("div",{className:"buttons-composer-wrapper",children:[Object(B.jsx)("div",{className:"tool",onClick:function(){return e.addColumns(1,a.selected)},children:Object(B.jsx)("img",{src:Ie,className:"tool-icon"})}),Object(B.jsx)("div",{className:"tool",onClick:function(){return e.removeColumns(1,a.selected)},children:Object(B.jsx)("img",{src:We,className:"tool-icon"})}),Object(B.jsx)("div",{className:"tool",onClick:function(){return e.addColumns(4===e.state.settings.beatMarks.value?20:15,"end")},children:Object(B.jsx)(H.a,{icon:G.l})})]})]})}),Object(B.jsx)(je,{functions:r,data:i})]}),Object(B.jsx)(fe,{data:s,functions:o}),Object(B.jsxs)("div",{className:"song-info",children:[Object(B.jsx)("div",{children:a.name}),Object(B.jsxs)("div",{children:[Ue(Ve(this.state.song,this.state.song.selected)),"/",Ue(Ve(this.state.song,this.state.song.columns.length))]})]})]})}}]),n}(i.Component),_e=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Je(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var ze=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var s;return Object(a.a)(this,n),(s=t.call(this,e)).changePage=function(e){s.setState({selectedPage:e})},s.logEvent=function(e){(e=e.detail).timestamp=(new Date).getTime(),"object"===typeof e&&(s.setState({floatingMessage:{timestamp:e.timestamp,visible:!0,text:e.text,title:e.title}}),setTimeout((function(){s.state.floatingMessage.timestamp===e.timestamp&&s.setState({floatingMessage:{timestamp:0,visible:!1,text:"",title:""}})}),e.timeout))},s.state={floatingMessage:{timestamp:0,visible:!1,text:"Text",title:"Title"},selectedPage:"App"},s}return Object(s.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("logEvent",this.logEvent)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("logEvent",this.logEvent)}},{key:"render",value:function(){var e=this.state.floatingMessage,t=e.visible?"floating-message floating-message-visible":"floating-message";return Object(B.jsxs)("div",{className:"index",children:[Object(B.jsxs)("div",{className:t,children:[Object(B.jsx)("div",{className:"floating-message-title",children:e.title}),Object(B.jsx)("div",{className:"floating-message-text",children:e.text})]}),"App"===this.state.selectedPage?Object(B.jsx)(le,{changePage:this.changePage}):Object(B.jsx)(B.Fragment,{}),"Composer"===this.state.selectedPage?Object(B.jsx)(Ge,{changePage:this.changePage}):Object(B.jsx)(B.Fragment,{})]})}}]),n}(i.Component);u.a.render(Object(B.jsx)(c.a.StrictMode,{children:Object(B.jsx)(ze,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat(".","/service-worker.js");_e?Je(t,e):(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Je(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")})))}))}}()},52:function(e,t,n){},53:function(e,t,n){},84:function(e,t,n){}},[[177,1,2]]]);
//# sourceMappingURL=main.23d7accf.chunk.js.map